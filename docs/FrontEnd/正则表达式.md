# 正则表达式

## 限定符

`?`代表前方字符可以出现 0 次或一次

`*`会匹配前方字符 0 个或多个字符

`+`会匹配前方字符出现 1 次及以上的字符

`{m,n}`指定字符出现次数范围，单个参数为 m 次或大于等于 m

## 多字符重复

`()`用括号包含多字符后添加限定符

## 或运算符

匹配`a (cat|dog)`会匹配 a cat 或 a dog

## 字符类

`[abc]+`会匹配有 abc 构成的字符串

`a-z`代表所有小写字母

`A-Z`代表所有大写字母

`0-9`代表所有数字构成的字符

`^`代表排除字符组成，包含换行符

## 元字符

`\d`代表数字字符

`\w`代表单词字符

`\s`代表空白符；包含 tab 字符和换行符

`\D`代表非数字字符

`\W`代表非单词字符

`\S`代表非空白字符

`.`代表任意字符但不包含换行符

`^a`匹配行首 a

`a$`匹配行尾 a

`\b`单词字符边界

## 贪婪和懒惰匹配

`<.+>`会贪婪匹配

`<.+?>`会是懒惰匹配
| 惰性量词 | 贪婪量词 |
|  ----  | ---- |
| {m,n}? | {m,n} |
| {m,}? | {m,} |
| ?? | ? |
| +? | + |
| *? | * |

## 反向引用
`/\d{4}(-|\/|\.)\d{2}\1\d{2}/`
里面的 \1，表示的引用之前的那个分组 (-|\/|\.)。不管它匹配到什么（比如 -），\1 都匹配那个同样的具体某个字符。
知道了 \1 的含义后，那么 \2 和 \3 的概念也就理解了，即分别指代第二个和第三个分组。
括号嵌套时以左括号（开括号）为准

如果只想要括号最原始的功能，但不会引用它，即，既不在 API 里引用，也不在正则里反向引用。
此时可以使用非捕获括号 (?:p) 和 (?:p1|p2|p3)

## 优先级
| 操作符描述 | 操作符 | 优先级 |
| ---- | ----| ---|
| 转义符 | \ | 1 |
| 括号和方括号 | (…)、(?:…)、(?=…)、(?!…)、[…] | 2 |
| 量词限定符 | {m}、{m,n}、{m,}、?、*、+ | 3 |
| 位置和序列 | ^、$、\元字符、一般字符 | 4 |
| 管道符（竖杠） | \| | 5 |

上面操作符的优先级从上至下，由高到低。

## 实例

**RGB 颜色值匹配**

`#[a-fA-F0-9]{6}\b`

**IPv4 地址匹配**

`\b((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)\b`

正则表达式后面的全局标记`g`指定将该表达式应用到输入字符串中能够查找到的尽可能多的匹配。

表达式的结尾处的不区分大小写`i`标记指定不区分大小写。

?
匹配前面的子表达式零次或一次。例如，"do(es)?" 可以匹配 "do" 或 "does" 。? 等价于 {0,1}。

{n}
n 是一个非负整数。匹配确定的 n 次。例如，'o{2}' 不能匹配 "Bob" 中的 'o'，但是能匹配 "food" 中的两个 o。

{n,}
n 是一个非负整数。至少匹配n 次。例如，'o{2,}' 不能匹配 "Bob" 中的 'o'，但能匹配 "foooood" 中的所有 o。'o{1,}' 等价于 'o+'。'o{0,}' 则等价于 'o*'。

{n,m}
m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。例如，"o{1,3}" 将匹配 "fooooood" 中的前三个 o。'o{0,1}' 等价于 'o?'。请注意在逗号和两个数之间不能有空格。

?
当该字符紧跟在任何一个其他限制符 (*, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串。例如，对于字符串 "oooo"，'o+?' 将匹配单个 "o"，而 'o+' 将匹配所有 'o'。

.
匹配除换行符（\n、\r）之外的任何单个字符。要匹配包括 '\n' 在内的任何字符，请使用像"(.|\n)"的模式。

(pattern)
匹配 pattern 并获取这一匹配。所获取的匹配可以从产生的 Matches 集合得到，在VBScript 中使用 SubMatches 集合，在JScript 中则使用 $0…$9 属性。要匹配圆括号字符，请使用 '\(' 或 '\)'。

(?:pattern)
匹配 pattern 但不获取匹配结果，也就是说这是一个非获取匹配，不进行存储供以后使用。这在使用 "或" 字符 (|) 来组合一个模式的各个部分是很有用。例如， 'industr(?:y|ies) 就是一个比 'industry|industries' 更简略的表达式。

(?=pattern)
正向肯定预查（look ahead positive assert），在任何匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如，"Windows(?=95|98|NT|2000)"能匹配"Windows2000"中的"Windows"，但不能匹配"Windows3.1"中的"Windows"。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始。

(?!pattern)
正向否定预查(negative assert)，在任何不匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如"Windows(?!95|98|NT|2000)"能匹配"Windows3.1"中的"Windows"，但不能匹配"Windows2000"中的"Windows"。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始。

(?<=pattern) 反向(look behind)肯定预查，与正向肯定预查类似，只是方向相反。例如，"(?<=95|98|NT|2000)Windows"能匹配"2000Windows"中的"Windows"，但不能匹配"3.1Windows"中的"Windows"。
(?<!pattern) 反向否定预查，与正向否定预查类似，只是方向相反。例如"(?<!95|98|NT|2000)Windows"能匹配"3.1Windows"中的"Windows"，但不能匹配"2000Windows"中的"Windows"。

速查表
| 模式 | 说明 |
| 字母、数字 | 匹配字面量本身。比如 /f/，匹配字母 "f"。 |
| \0 | 匹配 NUL 字符。 |
| \t | 匹配水平制表符。 | 
| \v | 匹配垂直制表符。 | 
| \n | 匹配换行符。 | 
| \r | 匹配回车符。 |
\f 匹配换页符。
\xnn 匹配拉丁字符。比如 \xOA 等价于 \n。
\uxxxx 匹配 Unicode 字符。比如 \u2028 匹配行终止符，\u2029 匹配段终止符。
\cX 匹配 ctrl+X。比如 \cI 匹配 ctrl+I，等价于 \t。
[\b] 匹配 Backspace 键（特殊记忆）。
字符组
模式 说明
[abc] 匹配 "a"、"b"、"c" 其中任何一个字符。
[a-d1-4] 匹配 "a"、"b"、"c"、"d"、"1"、"2"、"3"、"4" 其中任何一个字符。
[^abc] 匹配除了 "a"、"b"、"c" 之外的任何一个字符。
[^a-d1-4] 匹配除了 "a"、"b"、"c"、"d"、"1"、"2"、"3"、"4" 之外的任何一个字符。
. 通配符，匹配除了少数字符（\n）之外的任意字符。
\d 匹配数字，等价于 [0-9]。
\D 匹配非数字，等价于 [^0-9]。
\w 匹配单词字符，等价于 [a-zA-Z0-9_]。
\W 匹配非单词字符，等价于 [^a-zA-Z0-9_]。
\s 匹配空白符，等价于 [ \t\v\n\r\f]。
\S 匹配非空白符，等价于 [^ \t\v\n\r\f]。
量词
模式 说明
{n,m} 连续出现 n 到 m 次。贪婪模式。
{n,} 至少连续出现 n 次。贪婪模式。
{n} 连续出现 n 次。贪婪模式。
? 等价于 {0,1}。贪婪模式。
+ 等价于 {1,}。贪婪模式。
* 等价于 {0,}。贪婪模式。
{n,m}? 连续出现 n 到 m 次。惰性模式。
{n,}? 至少连续出现 n 次。惰性模式。
{n}? 连续出现 n 次。惰性模式。
?? 等价于 {0,1}?。惰性模式。
+? 等价于 {1,}?。惰性模式。
*? 等价于 {0,}?。惰性模式。
位置
模式
说明
^ 匹配开头的位置，当正则有修饰符 m 时，表示匹配行开头位置。
$ 匹配结尾的位置，当正则有修饰符 m 时，表示匹配行结尾位置。
\b 匹配单词边界，即，\w 与 \W、^ 与 \w、\w 与 $ 之间的位置。
\B 匹配非单词边界，即，\w 与 \w、\W 与 \W、^ 与 \W，\W 与 $ 之间的位置。
(?=abc) 匹配 "abc" 前面的位置，即此位置后面匹配 "abc"。
(?!abc) 匹配非 "abc" 前面的位置，即此位置后面不匹配 "abc"。
括号的作用
模式 说明
(ab) 捕获型分组。把 "ab" 当成一个整体，比如 (ab)+ 表示 "ab" 至少连续出现一次。
(?:ab) 非捕获型分组。与 (ab) 的区别是，它不捕获数据。
(good|nice) 捕获型分支结构。匹配 "good" 或 "nice"。
(?:good|nice) 非捕获型分支结构。与 (good|nice) 的区别是，它不捕获数据。
\num 反向引用。比如 \2，表示引用的是第二个括号里的捕获的数据。
修饰符
符号 说明
g 全局匹配，找到所有满足匹配的子串。
i 匹配过程中，忽略英文字母大小写。
m 多行匹配，把 ^ 和 $ 变成行开头和行结尾。
String相关实例方法
属性 方法作用说明
search 返回正则匹配到的第一个子串在目标字符串中的下标位置。
split 以正则匹配到的子串，对目标字符串进行切分。返回一个数组。
match 对目标字符串执行正则匹配操作，返回的匹配结果数组中包含具体的匹配信息。
replace 对目标字符串进行替换操作。正则是其第一个参数。返回替换后的字符串。
replace第二个参数中的特殊字符
字符 说明
$1,$2,…,$99 匹配第 1-99 个分组里捕获的文本
$& 匹配到的子串文本
$` 匹配到的子串的左边文本
$' 匹配到的子串的右边文本
$$ 美元符号
RegExp相关实例方法
属性 方法作用说明
test 判断目标字符串中是否有满足正则匹配的子串。返回布尔值。
exec 比 match 更强大的正则匹配操作。返回结果与 match 一致。
RegExp静态属性
属性 方法作用说明
$1,…,$9 最近一次第 1-9 个分组捕获的数据。
input 最近一次目标字符串，可以简写成 $_ 。
lastMatch 最近一次匹配的文本，可以简写成 $& 。
lastParen 最近一次捕获的文本，可以简写成 $+ 。
leftContext 目标字符串中 lastMatch 之前的文本，可以简写成 $` 。
rightContext 目标字符串中 lastMatch 之后的文本，可以简写成 $' 。
速查表 | 第 81 页JavaScript 正则表达式迷你书
术语中英文对照表
正则表达式 regular expressions
字符组 character classes
反义字符组 negated character classes
范围表达式法 range expressions
元字符 metacharacters
通配符 wildcard character
换行符 newline charactor
回车符 carriage return character
水平制表符 tab character
垂直制表符 vertical tab charecter
换页符 form feed character
空白符 whitespace
段终止符 paragraph terminator
行终止符 line terminator
单词字符 word characters
非单词字符 non-word characters
数字字符 digits
非数字字符 non-digits
字母数字字符 alphanumeric characters
量词 quantifiers
贪婪量词 greedy quantifiers
惰性量词 lazy quantifiers
位置 positions
锚 anchors
行开头 beginning of a line
行结尾 end of a line
单词边界 word boundaries
非单词边界 non-word boundaries
向前查找 lookahead
正向向前查找 positive lookahead
负向向前查找 negative lookahead
向后查找 lookbehind
正向向后查找 positive lookbehind
负向向后查找 negative lookbehind
分组 groups
捕获分组 capturing groups
非捕获分组 non-capturing groups
分支结构 alternations
反向引用 back references
回溯 backtracks
运算符 operators
术语中英文对照表 | 第 82 页JavaScript 正则表达式迷你书
优先级 priority level
修饰符 flags
全局匹配修饰符 global flag
忽略大小写修饰符 ingnoreCase flag
多行匹配修饰符 multiline flag
